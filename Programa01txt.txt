model {
for (i in 1:n) {
  y1[i] ~ dpois(lambda1[i])
  y2[i] ~ dpois(lambda2[i])
  SMR1[i] <- exp(eta1[i])
  SMR2[i] <- exp(eta2[i])
  lambda1[i] <- z1[i]*SMR1[i]
  lambda2[i] <- z2[i]*SMR2[i]
  eta1[i] ~ dnorm(mu1[i],prec.tau1)
  eta2[i] ~ dnorm(mu2[i],prec.tau2)
  mu1[i] <- alpha1 + u1[i] * delta + u2[i]
  mu2[i] <- alpha2 + u1[i]/delta
  # Standardized Bayesian residuals:
  res1[i] <- (y1[i] - lambda1[i])/sqrt(lambda1[i])
  res2[i] <- (y2[i] - lambda2[i])/sqrt(lambda2[i])
}
alpha1 ~ dflat()
alpha2 ~ dflat()
u1[1:n] ~ car.normal(adj[], weights[], num[], prec.v1)
u2[1:n] ~ car.normal(adj[], weights[], num[], prec.v2)
log(delta) <- ldelta
ldelta ~ dnorm(0,prec.delta)
tau1 ~ dgamma(1,0.01)
tau2 ~ dgamma(1,0.01)
v1 ~ dgamma(1,0.01)
v2 ~ dgamma(1,0.01)
prec.tau1 <- 1/tau1
prec.tau2 <- 1/tau2
prec.v1 <- 1/v1
prec.v2 <- 1/v2
prec.delta <- 1/0.17
for (j in 1:sumNumNeigh) {weights[j] <- 1}
}


list(n=68,
y1 = c(23, 375, 62, 14, 37, 16, 24, 32, 31, 37, 20, 19, 11, 19, 92, 
38, 79, 16, 27, 28, 12, 3, 21, 29, 9, 32, 81, 73, 135, 13, 16, 
11, 97, 37, 21, 17, 32, 42, 51, 19, 70, 11, 23, 13, 109, 90, 
43, 347, 41, 19, 27, 23, 25, 26, 54, 15, 4, 19, 141, 28, 57, 
9, 37, 14, 22, 50, 23, 10),
y2=c(11, 96, 29, 5, 14, 0, 12, 12, 16, 17, 11, 6, 6, 4, 18, 9, 37, 
6, 12, 9, 7, 1, 8, 4, 3, 5, 26, 23, 33, 11, 13, 7, 35, 8, 14, 
6, 16, 10, 21, 6, 18, 3, 7, 10, 27, 29, 10, 89, 14, 1, 14, 
9, 5, 6, 12, 6, 3, 4, 38, 11, 22, 3, 7, 4, 4, 14, 8, 3),
z1=c(27.74320631, 347.308068, 55.81185596, 15.41380166, 40.26136593, 
15.98322515, 25.29388289, 36.33143392, 38.6373399, 52.44012839, 
35.713544, 30.48968441, 15.99107452, 29.23818361, 89.15949828, 
40.28817554, 105.3222741, 25.77651973, 30.01482614, 41.6175622, 
15.34785146, 13.91276687, 25.73423855, 34.77694653, 19.51282117, 
28.62009448, 65.18392452, 75.84684502, 122.6757248, 19.86466335, 
26.50356138, 16.37406864, 67.71286388, 35.37210434, 28.91959744, 
20.42121475, 42.76878427, 39.44219857, 56.02709649, 15.58070039, 
51.92492136, 17.50696934, 28.29043002, 22.84146915, 83.87934653, 
80.81975248, 43.75571743, 280.1216842, 34.39169347, 15.65319059, 
28.01369311, 29.5859176, 22.31742386, 29.63608714, 46.77584775, 
16.49957866, 13.20317539, 18.81980075, 105.3905711, 21.54515126, 
62.58227816, 10.39506476, 37.42211028, 21.11731074, 25.07551532, 
41.28845522, 27.64410293, 15.06902366),
z2=c(8.949588304, 112.9781582, 18.20666722, 5.001609745, 13.14577247, 
5.146056395, 8.062571932, 11.38531402, 12.56494719, 16.91097075, 
11.0867482, 9.364401203, 5.0921413, 9.069256183, 27.99466828, 
12.56887434, 32.60178337, 7.78238775, 9.336102374, 13.08828323, 
5.081125646, 4.267423138, 7.808491324, 11.16931925, 6.170169307, 
9.09337444, 21.50228484, 24.64833095, 39.37268848, 6.19476598, 
8.588407045, 4.968299336, 22.14281072, 11.3960009, 9.093396781, 
6.438930837, 13.78234006, 12.29424159, 16.5811535, 4.54611217, 
15.53030154, 5.374782919, 8.40771871, 7.264960463, 26.66151243, 
25.19838869, 13.48181167, 84.38540434, 10.12843823, 4.634517207, 
8.273600164, 8.600706472, 6.537124131, 8.65954718, 14.25700325, 
4.837263206, 3.958120176, 5.606841706, 31.14141111, 6.435622515, 
19.80423779, 3.166315577, 11.26914757, 6.494768043, 7.328932119, 
12.39943791, 8.167154359, 4.518961789),
num=c(2, 4, 7, 3, 7, 8, 6, 5, 3, 7, 7, 5, 4, 3, 5, 5, 4, 3, 3, 3, 
6, 5, 4, 5, 6, 5, 3, 5, 5, 8, 5, 5, 4, 6, 7, 4, 3, 3, 5, 4, 4, 
3, 4, 7, 5, 6, 6, 5, 5, 8, 5, 2, 5, 6, 6, 7, 6, 5, 4, 4, 4, 7, 
7, 6, 7, 5, 4, 5),
adj=c(2, 33, 1, 3, 6, 34, 2, 4, 5, 6, 19, 21, 22, 3, 5, 6, 3, 4, 
6, 7, 10, 11, 22, 2, 3, 4, 5, 7, 30, 31, 34, 5, 6, 8, 10, 25, 
30, 7, 9, 10, 23, 25, 8, 10, 20, 5, 7, 8, 9, 11, 12, 20, 5, 10, 
12, 13, 15, 16, 22, 10, 11, 13, 14, 20, 11, 12, 14, 15, 12, 13, 
15, 11, 13, 14, 16, 17, 11, 15, 17, 21, 22, 15, 16, 18, 21, 17, 
19, 21, 3, 18, 21, 9, 10, 12, 3, 16, 17, 18, 19, 22, 3, 5, 11, 
16, 21, 8, 24, 25, 53, 23, 25, 32, 53, 54, 7, 8, 23, 24, 30, 
32, 28, 29, 31, 34, 35, 28, 29, 33, 26, 27, 29, 33, 34, 26, 27, 
28, 35, 38, 6, 7, 25, 31, 32, 35, 56, 62, 6, 26, 30, 34, 35, 
24, 25, 30, 54, 56, 1, 27, 28, 34, 2, 6, 26, 28, 31, 33, 26, 
29, 30, 31, 37, 38, 62, 37, 42, 44, 62, 35, 36, 38, 29, 35, 37, 
40, 41, 50, 60, 65, 39, 41, 49, 50, 39, 40, 49, 60, 36, 43, 44, 
42, 44, 48, 59, 36, 42, 43, 45, 48, 61, 62, 44, 46, 48, 61, 64, 
45, 47, 48, 63, 64, 68, 46, 48, 59, 65, 66, 68, 43, 44, 45, 46, 
47, 40, 41, 50, 51, 52, 39, 40, 49, 51, 55, 57, 58, 65, 49, 50, 
52, 53, 58, 49, 51, 23, 24, 51, 54, 58, 24, 32, 53, 55, 56, 58, 
50, 54, 56, 57, 58, 63, 30, 32, 54, 55, 62, 63, 64, 50, 55, 63, 
65, 66, 67, 50, 51, 53, 54, 55, 43, 47, 60, 65, 39, 41, 59, 65, 
44, 45, 62, 64, 30, 35, 36, 44, 56, 61, 64, 46, 55, 56, 57, 64, 
67, 68, 45, 46, 56, 61, 62, 63, 39, 47, 50, 57, 59, 60, 66, 47, 
57, 65, 67, 68, 57, 63, 66, 68, 46, 47, 63, 66, 67),
sumNumNeigh=340)


list(alpha1=0,alpha2=0,ldelta=1,tau1=1,tau2=1,v1=1,v2=1,
u1=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0),
u2=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0),
eta1=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0),
eta2=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0))

